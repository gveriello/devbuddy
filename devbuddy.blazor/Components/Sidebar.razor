@using devbuddy.common.Enums
@inherits PageComponentsBase

<div class="d-flex flex-column align-items-center align-items-sm-start px-3 pt-2 text-white min-vh-100 ">
	<ul class="nav flex-column mb-sm-auto mb-0 align-items-center align-items-sm-start" id="menu">
		@if (AllModules?.Count > 0)
		{
			//nodo home
			var homeNavItem = AllModules.FirstOrDefault(nav => nav.Node == ModulesItems.Home);
			<MenuNavItem NavNode="@homeNavItem.Node" Description="@homeNavItem.Description" Icon="@homeNavItem.Icon" OnNavItemClick="OnMenuItemClick" />
			//nodo unparented
			var unparentedItems = AllModules.Where(nav => string.IsNullOrEmpty(nav.Category) && nav.Node != ModulesItems.Home)?.ToList();
			if (unparentedItems?.Count > 0)
				foreach (var unparentedItem in unparentedItems)
				{
					<MenuNavItem NavNode="@unparentedItem.Node" Description="@unparentedItem.Description" Icon="@unparentedItem.Icon" OnNavItemClick="OnMenuItemClick" />
				}
			<hr />
			//nodi categorizzati
			var allCategories = AllModules.Where(nav => !string.IsNullOrEmpty(nav.Category))?.Select(nav => nav.Category.Trim()).Distinct().ToList();
			if (allCategories?.Count > 0)
				foreach (var category in allCategories)
				{
					var parentedItems = AllModules.Where(nav => nav.Category == category)?.ToList();
					if (parentedItems?.Count > 0)
					{
						<li class="nav-item" style="color:black; cursor:pointer" href="#@category" data-bs-toggle="collapse">

							<h5><i class="fa-solid fa-caret-right"></i> &nbsp;<i>@category</i></h5>
						</li>
						<div id="@category" class="collapse mb-3">
							@foreach (var parentedItem in parentedItems)
							{
								<MenuNavItem NavNode="@parentedItem.Node" Description="@parentedItem.Description" Icon="@parentedItem.Icon" OnNavItemClick="OnMenuItemClick" />
							}
						</div>
					}
				}
		}
	</ul>
	<hr>
	@if (User is not null)
	{
		<div class="dropdown pb-4">
			<a href="#" class="d-flex align-items-center text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
				@* <img src="https://github.com/mdo.png" alt="hugenerd" width="30" height="30" class="rounded-circle"> *@
				<i class="fa-solid fa-user rounded-circle" style="width:30px; height:30px;"></i>
				<span class="d-none d-sm-inline mx-1">@User.Name @User.Surname</span>
			</a>
			<ul class="dropdown-menu dropdown-menu-dark text-small shadow">
				<li><a class="dropdown-item" @onclick="@(() => OnLogout.InvokeAsync())" style="cursor:pointer">Disconnetti</a></li>
			</ul>
		</div>
	}

</div>
